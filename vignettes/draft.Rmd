---
title: "draft"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{draft}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
 library(multivaR)
library(dplyr)
library(data.table)
```


This is a rough draft vignette of how to run a typical workflow using multivaR


Step one is to assemble all the data for different variables into a single dataframe

```{r}

# step 1: assemble data

# search for azmpdata
# if azmpdata is not downloaded:
devtools::install_github("casaultb/azmpdata")
library(azmpdata)
query(search_key = '')

# load in desired data frames
data("Derived_Occupations_Sections")
data("Zooplankton_Occupations_Sections")

# collate data frames

datfr <- right_join(Derived_Occupations_Sections, Zooplankton_Occupations_Sections) 

```

If anomalies need to be calculated, multivaR has options for calculating monthly or annual anomalies with or without normalization.

```{r}
# monthly anomalies must be caluclated before annual anomalies (annual anomaly function simply combines monthly anomalies)

danomalies <- monthlyAnomaly(datfr, climatologyYears = c(1999, 2010), var = 'integrated_chlorophyll_0_100')

# annual anomalies function creates new data frame with just year and variable
chl_annual_anomalies <- annualAnomaly(danomalies, anomaly = 'integrated_chlorophyll_0_100_anomaly')

# if you are unsure which anomaly calculation to use you can use the wrapper function which will select the appropriate method 
calculate_anomaly(data = datfr, anomalyType = 'monthly', climatologyYears = c(1999, 2010), var = 'integrated_chlorophyll_0_100', normalizedAnomaly = TRUE)


calculate_anomaly(data = datfr, anomalyType = 'seasonal', climatologyYears = c(1999, 2010))

```
A note on caluclatinng anomalies, reference periods are used to create climatologies to calculate anomalies in this method. The current standard reference period is ... 


Once data is assembled, PCA can be run


```{r}
PCA(datfr[,9:15]) # subset dataframe to exclude metadata columns

```




